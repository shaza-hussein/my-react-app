{"ast":null,"code":"import { refreshToken } from '../API/Auth';\nimport { tokenManager, sessionManager } from './cookies';\n\n// ŸÖÿπÿßŸÑÿ¨ÿ© ÿÆÿ∑ÿ£ 401 (ÿ∫Ÿäÿ± ŸÖÿµÿ±ÿ≠)\nexport const handleUnauthorizedError = async (error, originalRequest, axiosInstance) => {\n  // ÿ•ÿ∞ÿß ŸÑŸÖ ŸÜŸÉŸÜ ŸÇÿØ ÿ≠ÿßŸàŸÑŸÜÿß ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ ŸÖŸÜ ŸÇÿ®ŸÑ\n  if (!originalRequest._retry) {\n    originalRequest._retry = true;\n    try {\n      const refreshTokenValue = tokenManager.getRefreshToken();\n      if (refreshTokenValue) {\n        console.log('üîÑ ŸÖÿ≠ÿßŸàŸÑÿ© ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ...');\n\n        // ÿ∑ŸÑÿ® ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ\n        const response = await refreshToken(refreshTokenValue);\n\n        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜÿ≤ ŸÅŸä ÿßŸÑŸÉŸàŸÉŸäÿ≤\n        tokenManager.updateTokens(response.access, response.refresh);\n\n        // ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ£ÿµŸÑŸä ŸÖÿπ ÿßŸÑÿ™ŸàŸÉŸÜ ÿßŸÑÿ¨ÿØŸäÿØ\n        originalRequest.headers.Authorization = `Bearer ${response.access}`;\n        console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ Ÿàÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ®');\n        return axiosInstance(originalRequest);\n      }\n    } catch (refreshError) {\n      console.log('‚ùå ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ:', refreshError);\n      handleRefreshTokenFailure();\n    }\n  }\n\n  // ÿ•ÿ∞ÿß ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ£Ÿà ÿ™ŸÖÿ™ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖŸÜ ŸÇÿ®ŸÑ\n  handleRefreshTokenFailure();\n  return Promise.reject(error);\n};\n\n// ŸÖÿπÿßŸÑÿ¨ÿ© ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ\nexport const handleRefreshTokenFailure = () => {\n  console.log('üßπ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿ®ÿ≥ÿ®ÿ® ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ');\n  sessionManager.clearSession();\n\n  // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ≠ÿØÿ´ ŸÑÿ≠ÿ∞ŸÅ ÿßŸÑÿ¨ŸÑÿ≥ÿ©\n  window.dispatchEvent(new CustomEvent('sessionExpired'));\n};\n\n// ŸÖÿπÿßŸÑÿ¨ÿ© ÿ£ÿÆÿ∑ÿßÿ° ÿπÿßŸÖÿ©\nexport const handleError = error => {\n  var _error$response;\n  console.log('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ∑ŸÑÿ®:', error);\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    handleRefreshTokenFailure();\n  }\n  return Promise.reject(error);\n};","map":{"version":3,"names":["refreshToken","tokenManager","sessionManager","handleUnauthorizedError","error","originalRequest","axiosInstance","_retry","refreshTokenValue","getRefreshToken","console","log","response","updateTokens","access","refresh","headers","Authorization","refreshError","handleRefreshTokenFailure","Promise","reject","clearSession","window","dispatchEvent","CustomEvent","handleError","_error$response","status"],"sources":["C:/Users/shaza/Desktop/test for NO/src/Config/errorHandler.js"],"sourcesContent":["import { refreshToken } from '../API/Auth';\r\nimport { tokenManager, sessionManager } from './cookies';\r\n\r\n// ŸÖÿπÿßŸÑÿ¨ÿ© ÿÆÿ∑ÿ£ 401 (ÿ∫Ÿäÿ± ŸÖÿµÿ±ÿ≠)\r\nexport const handleUnauthorizedError = async (error, originalRequest, axiosInstance) => {\r\n  // ÿ•ÿ∞ÿß ŸÑŸÖ ŸÜŸÉŸÜ ŸÇÿØ ÿ≠ÿßŸàŸÑŸÜÿß ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ ŸÖŸÜ ŸÇÿ®ŸÑ\r\n  if (!originalRequest._retry) {\r\n    originalRequest._retry = true;\r\n\r\n    try {\r\n      const refreshTokenValue = tokenManager.getRefreshToken();\r\n      if (refreshTokenValue) {\r\n        console.log('üîÑ ŸÖÿ≠ÿßŸàŸÑÿ© ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ...');\r\n        \r\n        // ÿ∑ŸÑÿ® ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ\r\n        const response = await refreshToken(refreshTokenValue);\r\n        \r\n        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜÿ≤ ŸÅŸä ÿßŸÑŸÉŸàŸÉŸäÿ≤\r\n        tokenManager.updateTokens(response.access, response.refresh);\r\n        \r\n        // ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ£ÿµŸÑŸä ŸÖÿπ ÿßŸÑÿ™ŸàŸÉŸÜ ÿßŸÑÿ¨ÿØŸäÿØ\r\n        originalRequest.headers.Authorization = `Bearer ${response.access}`;\r\n        console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ Ÿàÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∑ŸÑÿ®');\r\n        \r\n        return axiosInstance(originalRequest);\r\n      }\r\n    } catch (refreshError) {\r\n      console.log('‚ùå ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ:', refreshError);\r\n      handleRefreshTokenFailure();\r\n    }\r\n  }\r\n\r\n  // ÿ•ÿ∞ÿß ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ£Ÿà ÿ™ŸÖÿ™ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖŸÜ ŸÇÿ®ŸÑ\r\n  handleRefreshTokenFailure();\r\n  return Promise.reject(error);\r\n};\r\n\r\n// ŸÖÿπÿßŸÑÿ¨ÿ© ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ\r\nexport const handleRefreshTokenFailure = () => {\r\n  console.log('üßπ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿ®ÿ≥ÿ®ÿ® ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸàŸÉŸÜ');\r\n  sessionManager.clearSession();\r\n  \r\n  // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ≠ÿØÿ´ ŸÑÿ≠ÿ∞ŸÅ ÿßŸÑÿ¨ŸÑÿ≥ÿ©\r\n  window.dispatchEvent(new CustomEvent('sessionExpired'));\r\n};\r\n\r\n// ŸÖÿπÿßŸÑÿ¨ÿ© ÿ£ÿÆÿ∑ÿßÿ° ÿπÿßŸÖÿ©\r\nexport const handleError = (error) => {\r\n  console.log('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ∑ŸÑÿ®:', error);\r\n  \r\n  if (error.response?.status === 401) {\r\n    handleRefreshTokenFailure();\r\n  }\r\n  \r\n  return Promise.reject(error);\r\n}; "],"mappings":"AAAA,SAASA,YAAY,QAAQ,aAAa;AAC1C,SAASC,YAAY,EAAEC,cAAc,QAAQ,WAAW;;AAExD;AACA,OAAO,MAAMC,uBAAuB,GAAG,MAAAA,CAAOC,KAAK,EAAEC,eAAe,EAAEC,aAAa,KAAK;EACtF;EACA,IAAI,CAACD,eAAe,CAACE,MAAM,EAAE;IAC3BF,eAAe,CAACE,MAAM,GAAG,IAAI;IAE7B,IAAI;MACF,MAAMC,iBAAiB,GAAGP,YAAY,CAACQ,eAAe,CAAC,CAAC;MACxD,IAAID,iBAAiB,EAAE;QACrBE,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;;QAExC;QACA,MAAMC,QAAQ,GAAG,MAAMZ,YAAY,CAACQ,iBAAiB,CAAC;;QAEtD;QACAP,YAAY,CAACY,YAAY,CAACD,QAAQ,CAACE,MAAM,EAAEF,QAAQ,CAACG,OAAO,CAAC;;QAE5D;QACAV,eAAe,CAACW,OAAO,CAACC,aAAa,GAAG,UAAUL,QAAQ,CAACE,MAAM,EAAE;QACnEJ,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;QAE7C,OAAOL,aAAa,CAACD,eAAe,CAAC;MACvC;IACF,CAAC,CAAC,OAAOa,YAAY,EAAE;MACrBR,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEO,YAAY,CAAC;MAChDC,yBAAyB,CAAC,CAAC;IAC7B;EACF;;EAEA;EACAA,yBAAyB,CAAC,CAAC;EAC3B,OAAOC,OAAO,CAACC,MAAM,CAACjB,KAAK,CAAC;AAC9B,CAAC;;AAED;AACA,OAAO,MAAMe,yBAAyB,GAAGA,CAAA,KAAM;EAC7CT,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC;EAClDT,cAAc,CAACoB,YAAY,CAAC,CAAC;;EAE7B;EACAC,MAAM,CAACC,aAAa,CAAC,IAAIC,WAAW,CAAC,gBAAgB,CAAC,CAAC;AACzD,CAAC;;AAED;AACA,OAAO,MAAMC,WAAW,GAAItB,KAAK,IAAK;EAAA,IAAAuB,eAAA;EACpCjB,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEP,KAAK,CAAC;EAErC,IAAI,EAAAuB,eAAA,GAAAvB,KAAK,CAACQ,QAAQ,cAAAe,eAAA,uBAAdA,eAAA,CAAgBC,MAAM,MAAK,GAAG,EAAE;IAClCT,yBAAyB,CAAC,CAAC;EAC7B;EAEA,OAAOC,OAAO,CAACC,MAAM,CAACjB,KAAK,CAAC;AAC9B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}