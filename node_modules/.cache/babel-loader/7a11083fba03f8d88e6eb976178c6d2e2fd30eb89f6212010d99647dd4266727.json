{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nimport { useAuth } from '../Context/AuthContext';\nimport { handleLogoutError, validateSessionBeforeLogout, cleanupAfterLogout } from '../Utils/logoutHelper';\nexport default function useLogout() {\n  _s();\n  const [isLoggingOut, setIsLoggingOut] = useState(false);\n  const [error, setError] = useState(null);\n  const {\n    logout\n  } = useAuth();\n  const handleLogout = async () => {\n    if (isLoggingOut) return; // منع النقر المتكرر\n\n    setIsLoggingOut(true);\n    setError(null);\n    try {\n      // التحقق من صحة الجلسة قبل تسجيل الخروج\n      if (!validateSessionBeforeLogout()) {\n        console.log('⚠️ جلسة غير صالحة، سيتم حذف الجلسة المحلية فقط');\n        await logout();\n        return;\n      }\n\n      // تسجيل الخروج\n      await logout();\n\n      // تنظيف البيانات المحلية\n      cleanupAfterLogout();\n    } catch (error) {\n      // معالجة الأخطاء باستخدام الدالة المساعدة\n      const errorInfo = handleLogoutError(error);\n      setError(errorInfo.message);\n      setIsLoggingOut(false);\n\n      // في حالة خطأ 401، نستمر في حذف الجلسة المحلية\n      if (errorInfo.status === 401) {\n        console.log('🔑 التوكن منتهي الصلاحية، سيتم حذف الجلسة المحلية');\n        try {\n          await logout();\n        } catch (localLogoutError) {\n          console.error('خطأ في حذف الجلسة المحلية:', localLogoutError);\n        }\n      }\n    }\n  };\n  const clearError = () => {\n    setError(null);\n  };\n  return {\n    isLoggingOut,\n    error,\n    handleLogout,\n    clearError\n  };\n}\n_s(useLogout, \"d4lqb0qerbM/n/ToYjSgQMd53UI=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"names":["useState","useAuth","handleLogoutError","validateSessionBeforeLogout","cleanupAfterLogout","useLogout","_s","isLoggingOut","setIsLoggingOut","error","setError","logout","handleLogout","console","log","errorInfo","message","status","localLogoutError","clearError"],"sources":["C:/Users/shaza/Desktop/test for NO/src/Hooks/useLogout.js"],"sourcesContent":["import { useState } from 'react';\r\nimport { useAuth } from '../Context/AuthContext';\r\nimport { handleLogoutError, validateSessionBeforeLogout, cleanupAfterLogout } from '../Utils/logoutHelper';\r\n\r\nexport default function useLogout() {\r\n  const [isLoggingOut, setIsLoggingOut] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const { logout } = useAuth();\r\n\r\n  const handleLogout = async () => {\r\n    if (isLoggingOut) return; // منع النقر المتكرر\r\n    \r\n    setIsLoggingOut(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // التحقق من صحة الجلسة قبل تسجيل الخروج\r\n      if (!validateSessionBeforeLogout()) {\r\n        console.log('⚠️ جلسة غير صالحة، سيتم حذف الجلسة المحلية فقط');\r\n        await logout();\r\n        return;\r\n      }\r\n      \r\n      // تسجيل الخروج\r\n      await logout();\r\n      \r\n      // تنظيف البيانات المحلية\r\n      cleanupAfterLogout();\r\n      \r\n    } catch (error) {\r\n      // معالجة الأخطاء باستخدام الدالة المساعدة\r\n      const errorInfo = handleLogoutError(error);\r\n      setError(errorInfo.message);\r\n      setIsLoggingOut(false);\r\n      \r\n      // في حالة خطأ 401، نستمر في حذف الجلسة المحلية\r\n      if (errorInfo.status === 401) {\r\n        console.log('🔑 التوكن منتهي الصلاحية، سيتم حذف الجلسة المحلية');\r\n        try {\r\n          await logout();\r\n        } catch (localLogoutError) {\r\n          console.error('خطأ في حذف الجلسة المحلية:', localLogoutError);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const clearError = () => {\r\n    setError(null);\r\n  };\r\n\r\n  return {\r\n    isLoggingOut,\r\n    error,\r\n    handleLogout,\r\n    clearError\r\n  };\r\n} "],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,OAAO,QAAQ,wBAAwB;AAChD,SAASC,iBAAiB,EAAEC,2BAA2B,EAAEC,kBAAkB,QAAQ,uBAAuB;AAE1G,eAAe,SAASC,SAASA,CAAA,EAAG;EAAAC,EAAA;EAClC,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM;IAAEW;EAAO,CAAC,GAAGV,OAAO,CAAC,CAAC;EAE5B,MAAMW,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,IAAIL,YAAY,EAAE,OAAO,CAAC;;IAE1BC,eAAe,CAAC,IAAI,CAAC;IACrBE,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF;MACA,IAAI,CAACP,2BAA2B,CAAC,CAAC,EAAE;QAClCU,OAAO,CAACC,GAAG,CAAC,gDAAgD,CAAC;QAC7D,MAAMH,MAAM,CAAC,CAAC;QACd;MACF;;MAEA;MACA,MAAMA,MAAM,CAAC,CAAC;;MAEd;MACAP,kBAAkB,CAAC,CAAC;IAEtB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACd;MACA,MAAMM,SAAS,GAAGb,iBAAiB,CAACO,KAAK,CAAC;MAC1CC,QAAQ,CAACK,SAAS,CAACC,OAAO,CAAC;MAC3BR,eAAe,CAAC,KAAK,CAAC;;MAEtB;MACA,IAAIO,SAAS,CAACE,MAAM,KAAK,GAAG,EAAE;QAC5BJ,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAC;QAChE,IAAI;UACF,MAAMH,MAAM,CAAC,CAAC;QAChB,CAAC,CAAC,OAAOO,gBAAgB,EAAE;UACzBL,OAAO,CAACJ,KAAK,CAAC,4BAA4B,EAAES,gBAAgB,CAAC;QAC/D;MACF;IACF;EACF,CAAC;EAED,MAAMC,UAAU,GAAGA,CAAA,KAAM;IACvBT,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC;EAED,OAAO;IACLH,YAAY;IACZE,KAAK;IACLG,YAAY;IACZO;EACF,CAAC;AACH;AAACb,EAAA,CArDuBD,SAAS;EAAA,QAGZJ,OAAO;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}