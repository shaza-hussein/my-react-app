{"ast":null,"code":"var _s = $RefreshSig$();\n//src/Hooks/useVerifyOTP.js\nimport { useRef, useState } from \"react\";\nimport React from \"react\";\nimport { confirmOTP } from \"../API\";\nexport default function useVerifyOTP({\n  formData,\n  onSuccess\n}) {\n  _s();\n  const inputs = useRef([...Array(6)].map(() => /*#__PURE__*/React.createRef()));\n  const [error, setError] = useState(\"\");\n  const [resendMessage, setResendMessage] = useState(\"\");\n  const handleChange = (e, idx) => {\n    if (e.target.value.length === 1 && idx < 5) {\n      inputs.current[idx + 1].current.focus();\n    }\n  };\n  const handlePaste = e => {\n    const paste = e.clipboardData.getData('text').slice(0, 6);\n    paste.split('').forEach((char, idx) => {\n      if (inputs.current[idx].current) {\n        inputs.current[idx].current.value = char;\n      }\n    });\n    e.preventDefault();\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const otp_code = inputs.current.map(input => input.current.value).join(\"\");\n    try {\n      await confirmOTP({\n        ...formData,\n        otp_code\n      });\n      if (onSuccess) onSuccess(otp_code);\n    } catch (err) {\n      let msg = \"فشل التحقق من الرمز أو انتهاء صلاحيته.\";\n      if (err.response && err.response.data) {\n        if (typeof err.response.data === \"string\") {\n          msg = err.response.data;\n        } else if (typeof err.response.data === \"object\") {\n          msg = Object.values(err.response.data).flat().join(\"، \");\n        }\n      }\n      setError(msg);\n    }\n  };\n\n  // دالة إعادة الإرسال\n  const onResend = async () => {\n    setError(\"\");\n    setResendMessage(\"\");\n    try {\n      await confirmOTP({\n        ...formData,\n        otp_code: \"\"\n      });\n      setResendMessage(\"تم إرسال الرمز مرة أخرى بنجاح\");\n    } catch (err) {\n      setError(\"فشل في إعادة إرسال الرمز\");\n    }\n  };\n  return {\n    inputs: inputs.current,\n    handleChange,\n    handlePaste,\n    handleSubmit,\n    error,\n    resendMessage,\n    onResend\n  };\n}\n_s(useVerifyOTP, \"hNIycG3BsJ6OQ4AM/SF/BABDlG8=\");","map":{"version":3,"names":["useRef","useState","React","confirmOTP","useVerifyOTP","formData","onSuccess","_s","inputs","Array","map","createRef","error","setError","resendMessage","setResendMessage","handleChange","e","idx","target","value","length","current","focus","handlePaste","paste","clipboardData","getData","slice","split","forEach","char","preventDefault","handleSubmit","otp_code","input","join","err","msg","response","data","Object","values","flat","onResend"],"sources":["C:/Users/shaza/Desktop/test for NO/src/Hooks/useVerifyOTP.js"],"sourcesContent":["//src/Hooks/useVerifyOTP.js\r\nimport { useRef, useState } from \"react\";\r\nimport React from \"react\";\r\nimport { confirmOTP } from \"../API\";\r\n\r\nexport default function useVerifyOTP({ formData, onSuccess }) {\r\n  const inputs = useRef([...Array(6)].map(() => React.createRef()));\r\n  const [error, setError] = useState(\"\");\r\n  const [resendMessage, setResendMessage] = useState(\"\");\r\n\r\n  const handleChange = (e, idx) => {\r\n    if (e.target.value.length === 1 && idx < 5) {\r\n      inputs.current[idx + 1].current.focus();\r\n    }\r\n  };\r\n\r\n  const handlePaste = (e) => {\r\n    const paste = e.clipboardData.getData('text').slice(0, 6);\r\n    paste.split('').forEach((char, idx) => {\r\n      if (inputs.current[idx].current) {\r\n        inputs.current[idx].current.value = char;\r\n      }\r\n    });\r\n    e.preventDefault();\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const otp_code = inputs.current.map(input => input.current.value).join(\"\");\r\n    try {\r\n      await confirmOTP({ ...formData, otp_code });\r\n      if (onSuccess) onSuccess(otp_code);\r\n    } catch (err) {\r\n      let msg = \"فشل التحقق من الرمز أو انتهاء صلاحيته.\";\r\n      if (err.response && err.response.data) {\r\n        if (typeof err.response.data === \"string\") {\r\n          msg = err.response.data;\r\n        } else if (typeof err.response.data === \"object\") {\r\n          msg = Object.values(err.response.data).flat().join(\"، \");\r\n        }\r\n      }\r\n      setError(msg);\r\n    }\r\n  };\r\n\r\n  // دالة إعادة الإرسال\r\n  const onResend = async () => {\r\n    setError(\"\");\r\n    setResendMessage(\"\");\r\n    try {\r\n      await confirmOTP({ ...formData, otp_code: \"\" });\r\n      setResendMessage(\"تم إرسال الرمز مرة أخرى بنجاح\");\r\n    } catch (err) {\r\n      setError(\"فشل في إعادة إرسال الرمز\");\r\n    }\r\n  };\r\n\r\n  return { inputs: inputs.current, handleChange, handlePaste, handleSubmit, error, resendMessage, onResend };\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}